import"./vendor-88195046.js";const c=[2e3,5e3,1e4,3e4,6e4];function u(s,m=void 0,p=o=>o){let o,r,i,a=0;const n=new Set;function S(){const e=a;return a++,c[e>=c.length-1?c.length-1:e]}function f(){i&&clearTimeout(i),o&&(o.close(),o=void 0)}function w(){f(),n.size>0&&(i=setTimeout(()=>l(),S()))}async function l(){return i&&(clearTimeout(i),i=void 0),r||(o=new WebSocket(s),o.onmessage=e=>{n.forEach(t=>{t(p(e.data))})},o.onclose=e=>{n.forEach(t=>{t(void 0)}),w()},r=new Promise((e,t)=>{o&&(o.onerror=d=>{t(d),r=void 0},o.onopen=d=>{a=0,e(!0),r=void 0})}),r)}return{set(e){if(o){const t=typeof e=="object"?()=>o.send(JSON.stringify(e)):()=>o.send(e);o.readyState!==WebSocket.OPEN?l().then(t):t()}n.forEach(t=>{t(e)})},update(e){console.log("update")},subscribe(e){return l(),e(m),n.add(e),()=>{n.delete(e),n.size===0&&f()}}}}let g={x:-1,y:-1,z_tilt:[-1,-1,-1],z_obj:-1,laser_r:-1,laser_g:-1,shutter:!1,moving:!1,msg:""},_={n:8,x:0,y:0,z_tilt:19850,z_obj:32e3,laser_r:5,laser_g:5,flowcell:!1},h={n:0,img:""};const O=u(`ws://${window.location.hostname}:8000/img`,h,s=>JSON.parse(JSON.parse(s))),J=u(`ws://${window.location.hostname}:8000/status`,g,s=>JSON.parse(JSON.parse(s))),b=u(`ws://${window.location.hostname}:8000/user`,_,s=>JSON.parse(JSON.parse(s)));export{O as m,J as s,b as u};
