var k=Object.defineProperty,y=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var p=(e,t,s)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,a=(e,t)=>{for(var s in t||(t={}))x.call(t,s)&&p(e,s,t[s]);if(m)for(var s of m(t))z.call(t,s)&&p(e,s,t[s]);return e},l=(e,t)=>y(e,D(t));import{D as d}from"./vendor-b4247f54.js";const g={pump:{reagent:"",volume:0,op:"pump"},prime:{reagent:"",volume:0,op:"prime"},temp:{temp:25,wait:!0,op:"temp"},hold:{time:0,op:"hold"},takeimage:{name:"Test",path:".",xy0:[0,0],xy1:[1,1],channels:[!0,!0,!0,!0],z_tilt:19850,z_obj:32e3,save:!1,lasers:[0,0],laser_onoff:[!0,!0],od:[0,0],overlap:.1,op:"takeimage",z_from:0,z_to:0,z_spacing:232},autofocus:{channels:[!0,!0,!0,!0],laser_onoff:!0,laser:5,od:0,op:"autofocus"},goto:{step:1,n:4,op:"goto"}},O={name:"",port:1,v_pull:100,v_prime:200,v_push:2e3,wait:26},f={name:"",path:".",fc:!1,reagents:[{uid:0,reagent:a({},O)}],cmds:[{uid:0,cmd:a({},g.pump)}]};function J(e,t){return{name:e.name,fc:e.fc,path:e.path,reagents:e.reagents.map(s=>({uid:++t,reagent:s})),cmds:e.cmds.map(s=>({uid:++t,cmd:s}))}}function A(e){return{name:e.name,fc:e.fc,path:e.path,reagents:e.reagents.map(t=>t.reagent),cmds:e.cmds.map(t=>t.cmd)}}const j={x:-1,y:-1,z_tilt:[-1,-1,-1],z_obj:-1,od:[0,0],laser_onoff:[!0,!0],lasers:[-1,-1],shutter:!1,msg:"Idle"};function i(e,t,{f:s=JSON.parse,broadcastOnSet:u,beforeOpen:o}={}){let n;const{set:c,subscribe:h,update:_}=d(t);async function S(){o&&await o(),n=new WebSocket(e),n.onmessage=r=>{console.log(r.data),c(s(r.data))},n.onopen=()=>{},n.onclose=()=>{}}return c(t),S(),{set(r){n&&n.readyState===WebSocket.OPEN&&n.send(typeof r=="object"?JSON.stringify(r):r),u&&c(r)},update:_,subscribe:h}}function v(e,t,{f:s=JSON.parse,broadcastOnSet:u,beforeOpen:o}={}){return{subscribe:i(e,t,{f:s,broadcastOnSet:u,beforeOpen:o}).subscribe}}const w={block:"",max_uid:2,mode:"editingA",exps:[a({},f),a({},f)],image_params:l(a({},g.takeimage),{fc:!1})},C=v(`ws://${window.location.hostname}:8000/status`,a({},j)),b=d(a({},w)),N=i(`ws://${window.location.hostname}:8000/user`,a({},w),{beforeOpen:T}),I=i(`ws://${window.location.hostname}:8000/cmd`,{msg:"ok"},{broadcastOnSet:!1});async function T(){for(;;)try{const t=await(await fetch(`http://${window.location.hostname}:8000/usersettings`)).json();b.set(t);return}catch{console.error("Cannot get initial user settings.")}}function W(){let e=Date.now(),t=setTimeout(()=>{},1e3);b.subscribe(s=>{let u=Date.now();const o=()=>{N.set(s),e=Date.now()};u-e<1e3?(clearTimeout(t),t=setTimeout(o,1e3-(u-e))):o()})}W();export{g as a,I as c,f as e,J as f,O as r,C as s,A as t,b as u};
