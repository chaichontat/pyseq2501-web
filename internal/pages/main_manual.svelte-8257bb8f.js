var ie=Object.defineProperty;var ne=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var re=(n,e,t)=>e in n?ie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,le=(n,e)=>{for(var t in e||(e={}))oe.call(e,t)&&re(n,t,e[t]);if(ne)for(var t of ne(e))ue.call(e,t)&&re(n,t,e[t]);return n};import{S as te,i as se,s as ae,a7 as fe,e as v,w as P,c as w,a as E,x as V,d as f,b as p,g as k,y as D,q as N,o as B,B as A,a8 as me,a9 as ce,k as y,m as z,t as W,h as L,H as d,j as pe,aa as he,R as H,T as Z,ab as _e,U as ge,N as ee,v as $e,ac as de,ad as be,V as ve,Q as X,ae as J,_ as j,W as Y,X as x}from"../chunks/vendor-de2b3913.js";import{c as we,u as K}from"../chunks/store-28837846.js";import{P as ke,T as Ee}from"../chunks/takeimage-2b84a81c.js";import"../chunks/spinning-a5be6584.js";import"../chunks/coords-813c65ab.js";function Ce(n){let e;return{c(){e=v("div"),this.h()},l(t){e=w(t,"DIV",{class:!0}),E(e).forEach(f),this.h()},h(){p(e,"class","absolute w-full bg-blue-800 bottom-6 h-[90%] opacity-60")},m(t,r){k(t,e,r)},d(t){t&&f(e)}}}function qe(n){let e,t=n[3]+"",r;return{c(){e=v("span"),r=W(t),this.h()},l(a){e=w(a,"SPAN",{class:!0});var s=E(e);r=L(s,t),s.forEach(f),this.h()},h(){p(e,"class","absolute bottom-0 right-0 text-sm text-center translate-x-1 vert svelte-b05ewu")},m(a,s){k(a,e,s),d(e,r)},p(a,s){s&8&&t!==(t=a[3]+"")&&pe(r,t)},d(a){a&&f(e)}}}function Te(n){let e,t,r,a;return e=new me({props:{data:n[1],width:80,$$slots:{default:[Ce]},$$scope:{ctx:n}}}),r=new ce({props:{vertical:!0,count:5,$$slots:{default:[qe,({value:s})=>({3:s}),({value:s})=>s?8:0]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment),t=y(),P(r.$$.fragment)},l(s){V(e.$$.fragment,s),t=z(s),V(r.$$.fragment,s)},m(s,u){D(e,s,u),k(s,t,u),D(r,s,u),a=!0},p(s,u){const m={};u&2&&(m.data=s[1]),u&16&&(m.$$scope={dirty:u,ctx:s}),e.$set(m);const h={};u&24&&(h.$$scope={dirty:u,ctx:s}),r.$set(h)},i(s){a||(N(e.$$.fragment,s),N(r.$$.fragment,s),a=!0)},o(s){B(e.$$.fragment,s),B(r.$$.fragment,s),a=!1},d(s){A(e,s),s&&f(t),A(r,s)}}}function Se(n){let e,t,r;return t=new fe({props:{x1:-10,x2:4096+10,y1:0,y2:n[0],$$slots:{default:[Te]},$$scope:{ctx:n}}}),{c(){e=v("div"),P(t.$$.fragment),this.h()},l(a){e=w(a,"DIV",{class:!0});var s=E(e);V(t.$$.fragment,s),s.forEach(f),this.h()},h(){p(e,"class","w-full h-full box-border")},m(a,s){k(a,e,s),D(t,e,null),r=!0},p(a,[s]){const u={};s&1&&(u.y2=a[0]),s&18&&(u.$$scope={dirty:s,ctx:a}),t.$set(u)},i(a){r||(N(t.$$.fragment,a),r=!0)},o(a){B(t.$$.fragment,a),r=!1},d(a){a&&f(e),A(t)}}}function Ie(n,e){return n.map((t,r)=>({x:t,y:e[r]}))}function ye(n,e,t){let{hist:r}=e,a,s=[{x:0,y:0},{x:2e3,y:10}];return n.$$set=u=>{"hist"in u&&t(2,r=u.hist)},n.$$.update=()=>{n.$$.dirty&4&&r&&(t(1,s=Ie(r.bin_edges,r.counts)),t(0,a=Math.max(...r.counts)))},[a,s,r]}class ze extends te{constructor(e){super();se(this,e,ye,Se,ae,{hist:2})}}const Pe={n:0,img:[""],hist:[{counts:[10],bin_edges:[0]}],channels:[!1,!1,!1,!1]};function Ve(n){let e,t,r;return{c(){e=v("button"),t=W("Channel 0"),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var s=E(e);t=L(s,"Channel 0"),s.forEach(f),this.h()},h(){p(e,"class",r=j(G("green",n[17],n[6].image_params.channels[0]))+" svelte-132l8kq"),H(e,"bg-green-600",n[17])},m(a,s){k(a,e,s),d(e,t)},p(a,s){s&131136&&r!==(r=j(G("green",a[17],a[6].image_params.channels[0]))+" svelte-132l8kq")&&p(e,"class",r),s&131136&&H(e,"bg-green-600",a[17])},d(a){a&&f(e)}}}function De(n){let e,t,r;return{c(){e=v("button"),t=W("Channel 1"),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var s=E(e);t=L(s,"Channel 1"),s.forEach(f),this.h()},h(){p(e,"class",r=j(G("orange",n[17],n[6].image_params.channels[1]))+" svelte-132l8kq"),H(e,"bg-orange-500",n[17])},m(a,s){k(a,e,s),d(e,t)},p(a,s){s&131136&&r!==(r=j(G("orange",a[17],a[6].image_params.channels[1]))+" svelte-132l8kq")&&p(e,"class",r),s&131136&&H(e,"bg-orange-500",a[17])},d(a){a&&f(e)}}}function Ne(n){let e,t,r;return{c(){e=v("button"),t=W("Channel 2"),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var s=E(e);t=L(s,"Channel 2"),s.forEach(f),this.h()},h(){p(e,"class",r=j(G("rose",n[17],n[6].image_params.channels[2]))+" svelte-132l8kq"),H(e,"bg-rose-600",n[17])},m(a,s){k(a,e,s),d(e,t)},p(a,s){s&131136&&r!==(r=j(G("rose",a[17],a[6].image_params.channels[2]))+" svelte-132l8kq")&&p(e,"class",r),s&131136&&H(e,"bg-rose-600",a[17])},d(a){a&&f(e)}}}function Be(n){let e,t,r;return{c(){e=v("button"),t=W("Channel 3"),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var s=E(e);t=L(s,"Channel 3"),s.forEach(f),this.h()},h(){p(e,"class",r=j(G("amber",n[17],n[6].image_params.channels[3]))+" svelte-132l8kq"),H(e,"bg-amber-800",n[17])},m(a,s){k(a,e,s),d(e,t)},p(a,s){s&131136&&r!==(r=j(G("amber",a[17],a[6].image_params.channels[3]))+" svelte-132l8kq")&&p(e,"class",r),s&131136&&H(e,"bg-amber-800",a[17])},d(a){a&&f(e)}}}function Ae(n){let e,t,r,a,s,u,m,h;return e=new J({props:{disabled:!n[6].image_params.channels[0],$$slots:{default:[Ve,({selected:l})=>({17:l}),({selected:l})=>l?131072:0]},$$scope:{ctx:n}}}),r=new J({props:{disabled:!n[6].image_params.channels[1],$$slots:{default:[De,({selected:l})=>({17:l}),({selected:l})=>l?131072:0]},$$scope:{ctx:n}}}),s=new J({props:{disabled:!n[6].image_params.channels[2],$$slots:{default:[Ne,({selected:l})=>({17:l}),({selected:l})=>l?131072:0]},$$scope:{ctx:n}}}),m=new J({props:{disabled:!n[6].image_params.channels[3],$$slots:{default:[Be,({selected:l})=>({17:l}),({selected:l})=>l?131072:0]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment),t=y(),P(r.$$.fragment),a=y(),P(s.$$.fragment),u=y(),P(m.$$.fragment)},l(l){V(e.$$.fragment,l),t=z(l),V(r.$$.fragment,l),a=z(l),V(s.$$.fragment,l),u=z(l),V(m.$$.fragment,l)},m(l,o){D(e,l,o),k(l,t,o),D(r,l,o),k(l,a,o),D(s,l,o),k(l,u,o),D(m,l,o),h=!0},p(l,o){const b={};o&64&&(b.disabled=!l[6].image_params.channels[0]),o&393280&&(b.$$scope={dirty:o,ctx:l}),e.$set(b);const g={};o&64&&(g.disabled=!l[6].image_params.channels[1]),o&393280&&(g.$$scope={dirty:o,ctx:l}),r.$set(g);const S={};o&64&&(S.disabled=!l[6].image_params.channels[2]),o&393280&&(S.$$scope={dirty:o,ctx:l}),s.$set(S);const C={};o&64&&(C.disabled=!l[6].image_params.channels[3]),o&393280&&(C.$$scope={dirty:o,ctx:l}),m.$set(C)},i(l){h||(N(e.$$.fragment,l),N(r.$$.fragment,l),N(s.$$.fragment,l),N(m.$$.fragment,l),h=!0)},o(l){B(e.$$.fragment,l),B(r.$$.fragment,l),B(s.$$.fragment,l),B(m.$$.fragment,l),h=!1},d(l){A(e,l),l&&f(t),A(r,l),l&&f(a),A(s,l),l&&f(u),A(m,l)}}}function Ue(n){let e,t;return e=new be({props:{class:"grid grid-cols-4 p-1 space-x-1 bg-white shadow rounded-xl opacity-90 ",$$slots:{default:[Ae]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){D(e,r,a),t=!0},p(r,a){const s={};a&262208&&(s.$$scope={dirty:a,ctx:r}),e.$set(s)},i(r){t||(N(e.$$.fragment,r),t=!0)},o(r){B(e.$$.fragment,r),t=!1},d(r){A(e,r)}}}function He(n){let e,t,r,a,s,u,m,h,l,o,b,g,S,C,q,T,I,U,F;return s=new he({props:{$$slots:{default:[Ue]},$$scope:{ctx:n}}}),s.$on("change",n[10]),T=new ze({props:{hist:n[1].hist[n[0]]}}),{c(){e=v("div"),t=v("canvas"),r=y(),a=v("div"),P(s.$$.fragment),u=y(),m=v("button"),h=W("Center"),l=y(),o=v("div"),b=v("label"),g=v("input"),S=W(`
      Show Histogram`),C=y(),q=v("div"),P(T.$$.fragment),this.h()},l(c){e=w(c,"DIV",{id:!0,class:!0});var _=E(e);t=w(_,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),E(t).forEach(f),r=z(_),a=w(_,"DIV",{class:!0});var R=E(a);V(s.$$.fragment,R),R.forEach(f),u=z(_),m=w(_,"BUTTON",{class:!0});var O=E(m);h=L(O,"Center"),O.forEach(f),l=z(_),o=w(_,"DIV",{class:!0});var i=E(o);b=w(i,"LABEL",{class:!0});var $=E(b);g=w($,"INPUT",{type:!0,class:!0}),S=L($,`
      Show Histogram`),$.forEach(f),i.forEach(f),C=z(_),q=w(_,"DIV",{id:!0,class:!0});var M=E(q);V(T.$$.fragment,M),M.forEach(f),_.forEach(f),this.h()},h(){p(t,"id","canvas"),p(t,"width",2048),p(t,"height",128),p(t,"class","svelte-132l8kq"),p(a,"class","absolute z-40 w-2/5 h-10 top-4 left-4"),p(m,"class","absolute z-40 inline-flex items-center h-10 px-4 font-medium bg-white border rounded-lg shadow-lg top-4 right-56 opacity-90 white-button"),p(g,"type","checkbox"),p(g,"class","mr-1 text-blue-500 rounded focus:ring-blue-300"),p(b,"class","mx-4 font-medium cursor-pointer"),p(o,"class","absolute z-40 inline-flex items-center h-10 bg-white border rounded-lg shadow-lg top-4 right-8 opacity-90"),p(q,"id","histogram"),p(q,"class","absolute z-30 p-6 pb-3 bg-white rounded-lg shadow-lg shadow-gray-500 bottom-8 right-8 opacity-90 w-[400px] h-[300px]"),H(q,"hidden",!n[5]),p(e,"id","frame"),p(e,"class","relative z-10 w-11/12 mx-auto mt-4 border border-gray-300 rounded-md resize-y min-h-[40vh] svelte-132l8kq")},m(c,_){k(c,e,_),d(e,t),n[9](t),d(e,r),d(e,a),D(s,a,null),d(e,u),d(e,m),d(m,h),d(e,l),d(e,o),d(o,b),d(b,g),g.checked=n[5],d(b,S),d(e,C),d(e,q),D(T,q,null),n[14](e),I=!0,U||(F=[Z(t,"wheel",function(){_e(n[4].zoomWithWheel)&&n[4].zoomWithWheel.apply(this,arguments)}),Z(m,"click",n[11]),Z(g,"change",n[12]),Z(g,"click",n[13])],U=!0)},p(c,[_]){n=c;const R={};_&262208&&(R.$$scope={dirty:_,ctx:n}),s.$set(R),_&32&&(g.checked=n[5]);const O={};_&3&&(O.hist=n[1].hist[n[0]]),T.$set(O),_&32&&H(q,"hidden",!n[5])},i(c){I||(N(s.$$.fragment,c),N(T.$$.fragment,c),I=!0)},o(c){B(s.$$.fragment,c),B(T.$$.fragment,c),I=!1},d(c){c&&f(e),n[9](null),A(s),A(T),n[14](null),U=!1,ge(F)}}}function G(n,e,t){return`tab-button ${e?"text-white":`${t?`text-gray-700 hover:text-black bg-white hover:bg-${n}-300`:"text-gray-400"}`}`}function Oe(n,e,t){let r,a;ee(n,we,c=>t(8,r=c)),ee(n,K,c=>t(6,a=c));let s,u,m,h,l,o=!0,b=0,g=le({},Pe);$e(()=>{t(7,l=u.getContext("2d")),t(4,h=de(u,{animate:!0,maxZoom:5,startScale:.4,origin:"0 0"}))}),m=new Image,m.onload=()=>l==null?void 0:l.drawImage(m,0,0);function S(c){c.msg==="imgReady"&&fetch(`http://${window.location.hostname}:8000/img`).then(_=>_.json()).then(_=>t(1,g=_)).catch(_=>alert(_)),ve(K,a.block="",a)}function C(c){X[c?"unshift":"push"](()=>{u=c,t(3,u)})}const q=c=>t(0,b=c.detail),T=()=>{h.pan(0,0)};function I(){o=this.checked,t(5,o)}const U=()=>t(5,o=!o);function F(c){X[c?"unshift":"push"](()=>{s=c,t(2,s)})}return n.$$.update=()=>{n.$$.dirty&256&&S(r),n.$$.dirty&3&&(m.src=g.img[b]),n.$$.dirty&130&&l&&g&&t(7,l.canvas.height=128*g.n,l)},[b,g,s,u,h,o,a,l,r,C,q,T,I,U,F]}class We extends te{constructor(e){super();se(this,e,Oe,He,ae,{})}}function Le(n){let e,t,r,a,s,u,m,h,l,o,b,g,S,C,q,T,I,U;function F(i){n[2](i)}let c={};n[1]!==void 0&&(c.stats=n[1]),a=new ke({props:c}),X.push(()=>Y(a,"stats",F));function _(i){n[3](i)}function R(i){n[4](i)}let O={};return n[0].image_params!==void 0&&(O.params=n[0].image_params),n[1]!==void 0&&(O.stats=n[1]),o=new Ee({props:O}),X.push(()=>Y(o,"params",_)),X.push(()=>Y(o,"stats",R)),I=new We({}),{c(){e=v("div"),t=v("div"),r=y(),P(a.$$.fragment),u=y(),m=v("p"),h=W("Capture Parameters"),l=y(),P(o.$$.fragment),S=y(),C=v("p"),q=W("Preview"),T=y(),P(I.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var $=E(e);t=w($,"DIV",{class:!0}),E(t).forEach(f),r=z($),V(a.$$.fragment,$),$.forEach(f),u=z(i),m=w(i,"P",{class:!0});var M=E(m);h=L(M,"Capture Parameters"),M.forEach(f),l=z(i),V(o.$$.fragment,i),S=z(i),C=w(i,"P",{class:!0});var Q=E(C);q=L(Q,"Preview"),Q.forEach(f),T=z(i),V(I.$$.fragment,i),this.h()},h(){p(t,"class","w-full h-4"),p(e,"class","box-border sticky z-40 -mx-10 px-10 pb-6 shadow-md bg-white/[0.95] border-b top-16 "),p(m,"class","mt-6 title"),p(C,"class","title")},m(i,$){k(i,e,$),d(e,t),d(e,r),D(a,e,null),k(i,u,$),k(i,m,$),d(m,h),k(i,l,$),D(o,i,$),k(i,S,$),k(i,C,$),d(C,q),k(i,T,$),D(I,i,$),U=!0},p(i,[$]){const M={};!s&&$&2&&(s=!0,M.stats=i[1],x(()=>s=!1)),a.$set(M);const Q={};!b&&$&1&&(b=!0,Q.params=i[0].image_params,x(()=>b=!1)),!g&&$&2&&(g=!0,Q.stats=i[1],x(()=>g=!1)),o.$set(Q)},i(i){U||(N(a.$$.fragment,i),N(o.$$.fragment,i),N(I.$$.fragment,i),U=!0)},o(i){B(a.$$.fragment,i),B(o.$$.fragment,i),B(I.$$.fragment,i),U=!1},d(i){i&&f(e),A(a),i&&f(u),i&&f(m),i&&f(l),A(o,i),i&&f(S),i&&f(C),i&&f(T),A(I,i)}}}function Me(n,e){n&&(n.querySelectorAll("input").forEach(t=>t.disabled=e),n.querySelectorAll("select").forEach(t=>t.disabled=e),n.querySelectorAll("button").forEach(t=>t.disabled=e))}function je(n,e,t){let r;ee(n,K,h=>t(0,r=h));let a={height:0,width:0,n_cols:0,n_bundles:0,n_z:1,time:0};function s(h){a=h,t(1,a)}function u(h){n.$$.not_equal(r.image_params,h)&&(r.image_params=h,K.set(r))}function m(h){a=h,t(1,a)}return n.$$.update=()=>{n.$$.dirty&1&&Me(document.getElementById("control"),r.block)},[r,a,s,u,m]}class Je extends te{constructor(e){super();se(this,e,je,Le,ae,{})}}export{Je as default};
